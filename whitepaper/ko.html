<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nostra 기술 백서 - 시장 모델 및 오라클 통합</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div class="container">
        <header>
            <div class="lang-switch">
                <a href="index.html" class="lang-link">🇺🇸 English</a>
            </div>
            <h1>Nostra 기술 백서</h1>
            <p class="subtitle">고급 시장 모델 및 체인링크 오라클 통합</p>
            <p class="author-info">작성자: 이현재 | 2025년 12월</p>
        </header>

        <nav class="toc">
            <h2>목차</h2>
            <div class="toc-grid">
                <div>
                    <div class="toc-section-title">1부: 시장 설계 기초</div>
                    <ul>
                        <li><a href="#market-structures">1.1 시장 구조</a></li>
                        <li><a href="#initial-probability">1.2 초기 확률 설정</a></li>
                        <li><a href="#liquidity-provision">1.3 유동성 공급</a></li>
                        <li><a href="#stuck-inventory">1.4 재고 고립 문제</a></li>
                        <li><a href="#market-makers">1.5 마켓 메이커</a></li>
                        <li><a href="#fee-structure">1.6 수수료 구조</a></li>
                        <li><a href="#amm-vs-orderbook">1.7 AMM vs 오더북</a></li>
                        <li><a href="#platform-economics">1.8 플랫폼 경제학</a></li>
                        <li><a href="#implementation">1.9 구현 고려사항</a></li>
                    </ul>
                </div>
                <div>
                    <div class="toc-section-title">2부: 시장 모델</div>
                    <ul>
                        <li><a href="#model-comparison">2.1 모델 비교 개요</a></li>
                        <li><a href="#grouped-binary">2.2 Grouped Binary 모델 (Nostra)</a></li>
                        <li><a href="#ctf-multi">2.3 CTF 다중 결과 모델</a></li>
                        <li><a href="#negrisk">2.4 NegRisk 어댑터 (Polymarket)</a></li>
                        <li><a href="#negrisk-conversion">2.5 NegRisk 변환 메커니즘</a></li>
                        <li><a href="#negrisk-arch">2.6 NegRisk 아키텍처</a></li>
                        <li><a href="#implementation-options">2.7 구현 옵션</a></li>
                    </ul>
                </div>
                <div>
                    <div class="toc-section-title">3부: 체인링크 통합</div>
                    <ul>
                        <li><a href="#why-chainlink">3.1 시장 해결을 위한 체인링크</a></li>
                        <li><a href="#chainlink-setup">3.2 체인링크 시작하기</a></li>
                        <li><a href="#long-tail-markets">3.3 롱테일 시장 처리</a></li>
                        <li><a href="#chainlink-products">3.4 체인링크 제품 개요</a></li>
                        <li><a href="#resolution-arch">3.5 해결 아키텍처</a></li>
                        <li><a href="#smart-contracts">3.6 스마트 컨트랙트 통합</a></li>
                        <li><a href="#cost-security">3.7 비용 및 보안</a></li>
                        <li><a href="#roadmap">3.8 구현 로드맵</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- PART 1: MARKET DESIGN FUNDAMENTALS -->
        <div class="part-divider">
            <h2>1부: 시장 설계 기초</h2>
            <span class="part-subtitle">예측 시장 경제학의 이해</span>
        </div>

        <!-- Section 1.1: Market Structures -->
        <section id="market-structures" class="part-1-section">
            <h3><span class="section-num part-1">1.1</span>시장 구조</h3>

            <h4>두 가지 주요 접근 방식</h4>

            <div class="grid-2">
                <div class="card">
                    <h4><span class="label label-accent">50% Grouped Binary</span></h4>
                    <ul>
                        <li>각 결과는 50% YES / 50% NO로 시작</li>
                        <li>시장은 독립적임 (연결되지 않음)</li>
                        <li>YES의 합은 무엇이든 될 수 있음 (N × 50%)</li>
                        <li>차익거래를 통해 ~100%로 수렴</li>
                        <li>구현이 간단함</li>
                    </ul>
                    <pre
                        style="font-size: 0.85rem; margin: 0; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px;">5개 결과가 각각 50%일 때:
합계 = 250%
(거래를 통해 수렴)</pre>
                </div>

                <div class="card">
                    <h4><span class="label label-success">100/n% Binary Market</span></h4>
                    <ul>
                        <li>각 결과는 100/N %로 시작</li>
                        <li>독립적이거나 기계적으로 연결될 수 있음 (CTF)</li>
                        <li>YES의 합 = 100%</li>
                        <li>초기 차익거래 기회 없음</li>
                        <li>제작자가 초기에 차익거래자에게 손해를 보지 않음</li>
                    </ul>
                    <pre
                        style="font-size: 0.85rem; margin: 0; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px;">5개 결과가 각각 20%일 때:
합계 = 100%
(차익거래 기회 없음)</pre>
                </div>
            </div>

            <h4>Polymarket의 하이브리드 접근 방식 (NegRisk CTF)</h4>

            <div class="box box-highlight">
                <span class="box-title">시장에 따른 다른 구조</span>
                <ul>
                    <li><strong>거래량이 많은 시장 (예: 슈퍼볼)</strong>: NegRisk CTF - YES + NO = 결과당 100¢</li>
                    <li><strong>거래량이 적은 시장 (예: CFP)</strong>: Grouped Binary - YES + NO ≠ 100¢</li>
                </ul>
            </div>

            <pre
                style="font-size: 0.85rem; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px; margin: 1rem 0;">슈퍼볼 (NegRisk CTF):
┌────────────┬───────┬───────┬──────────┐
│ 팀         │ YES   │ NO    │ YES + NO │
├────────────┼───────┼───────┼──────────┤
│ Chiefs     │ 23¢   │ 77¢   │ 100¢ ✓   │
│ Eagles     │ 19¢   │ 81¢   │ 100¢ ✓   │
└────────────┴───────┴───────┴──────────┘

CFP (Grouped Binary):
┌────────────┬───────┬───────┬──────────┐
│ 팀         │ YES   │ NO    │ YES + NO │
├────────────┼───────┼───────┼──────────┤
│ Indiana    │ 93.4¢ │ 99¢   │ 192.4¢   │
│ Ohio State │ 72¢   │ 98¢   │ 170¢     │
└────────────┴───────┴───────┴──────────┘</pre>
        </section>

        <!-- Section 1.2: Initial Probability Settings -->
        <section id="initial-probability" class="part-1-section">
            <h3><span class="section-num part-1">1.2</span>초기 확률 설정</h3>

            <h4>50% 초기 확률의 문제점</h4>

            <div class="box box-danger">
                <span class="box-title">차익거래 손실</span>
                각 결과가 50%에서 시작하면 합계가 100%를 초과하여, 제작자의 비용으로 차익거래자에게 보장된 수익을 제공합니다.
            </div>

            <pre
                style="font-size: 0.85rem; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px; margin: 1rem 0;">5개 결과가 각각 50%일 때:
합계 = 250%

차익거래자:
- 모든 NO 토큰 매수
- 한 결과가 패배할 때 보장된 수익
- 제작자는 차익거래자에게 손실</pre>

            <h4>해결책: 100/n% 초기 확률</h4>

            <div class="box box-success">
                <span class="box-title">차익거래 없음</span>
                100/n%에서 시작하면 합계 = 100%입니다. 차익거래자에게 공짜 돈을 주지 않습니다.
            </div>

            <h4>중요한 설명: 250% 합계는 차익거래가 아닙니다</h4>

            <div class="box box-warning">
                <span class="box-title">흔한 오해</span>
                Grouped Binary 시장에서 250% 합계(5 × 50%)는 차익거래를 생성하지 않습니다. 각 시장은 독립적입니다!
            </div>

            <pre
                style="font-size: 0.85rem; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px; margin: 1rem 0;">Grouped Binary (5개 결과 × 50%):

시장 1: 팀 A  YES (50¢) + NO (50¢) = $1 ✓
시장 2: 팀 B  YES (50¢) + NO (50¢) = $1 ✓
시장 3: 팀 C  YES (50¢) + NO (50¢) = $1 ✓
시장 4: 팀 D  YES (50¢) + NO (50¢) = $1 ✓
시장 5: 팀 E  YES (50¢) + NO (50¢) = $1 ✓

YES의 합 = 250%... 하지만 그래서요?

왜 차익거래가 아닌가?
• 각 시장은 독립적입니다
• 다른 시장 간에 토큰을 병합할 수 없습니다
• 각 시장은 개별적으로 YES + NO = $1 ✓

250% → 100% 수렴은 단지 가격 발견(Price Discovery)일 뿐,
차익거래가 아닙니다. 스마트 트레이더들이 이를 정상화합니다.</pre>

            <h4>진짜 차익거래란 무엇인가?</h4>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>케이스</th>
                            <th>조건</th>
                            <th>행동</th>
                            <th>결과</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>단일 시장</td>
                            <td>YES + NO < $1</td>
                            <td>둘 다 매수</td>
                            <td>보장된 수익</td>
                        </tr>
                        <tr>
                            <td>단일 시장</td>
                            <td>YES + NO > $1</td>
                            <td>둘 다 발행 및 매도</td>
                            <td>보장된 수익</td>
                        </tr>
                        <tr>
                            <td>CTF 다중 결과</td>
                            <td>합계 < $1</td>
                            <td>모두 매수, 병합</td>
                            <td>보장된 수익</td>
                        </tr>
                        <tr>
                            <td>CTF 다중 결과</td>
                            <td>합계 > $1</td>
                            <td>분할 및 모두 매도</td>
                            <td>보장된 수익</td>
                        </tr>
                        <tr>
                            <td>크로스 플랫폼</td>
                            <td>YES_A + NO_B < $1</td>
                            <td>양쪽 매수</td>
                            <td>보장된 수익</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <p><strong>핵심:</strong> 차익거래는 <strong>무위험, 보장된 수익</strong>을 의미합니다. 250% 합계는 이에 해당하지 않습니다.</p>

            <h4>비교: 5개 결과 (실제 확률: 60%, 15%, 10%, 10%, 5%)</h4>

            <div class="grid-2">
                <div class="card">
                    <h4>50% 초기 (합계 = 250%)</h4>
                    <div class="table-wrapper">
                        <table>
                            <tr>
                                <th>결과</th>
                                <th>초기</th>
                                <th>공정가</th>
                                <th>차이</th>
                            </tr>
                            <tr>
                                <td>A (우승후보)</td>
                                <td>50¢</td>
                                <td>60¢</td>
                                <td style="color: var(--danger);">-10¢</td>
                            </tr>
                            <tr>
                                <td>B</td>
                                <td>50¢</td>
                                <td>15¢</td>
                                <td style="color: var(--success);">+35¢</td>
                            </tr>
                            <tr>
                                <td>C</td>
                                <td>50¢</td>
                                <td>10¢</td>
                                <td style="color: var(--success);">+40¢</td>
                            </tr>
                            <tr>
                                <td>D</td>
                                <td>50¢</td>
                                <td>10¢</td>
                                <td style="color: var(--success);">+40¢</td>
                            </tr>
                            <tr>
                                <td>E</td>
                                <td>50¢</td>
                                <td>5¢</td>
                                <td style="color: var(--success);">+45¢</td>
                            </tr>
                        </table>
                    </div>
                    <p>우승후보: 약간 저평가 (-10¢)<br>언더독: 극심한 고평가 (+35~45¢)</p>
                </div>

                <div class="card">
                    <h4>100/n% = 20% 초기 (합계 = 100%)</h4>
                    <div class="table-wrapper">
                        <table>
                            <tr>
                                <th>결과</th>
                                <th>초기</th>
                                <th>공정가</th>
                                <th>차이</th>
                            </tr>
                            <tr>
                                <td>A (우승후보)</td>
                                <td>20¢</td>
                                <td>60¢</td>
                                <td style="color: var(--danger);">-40¢</td>
                            </tr>
                            <tr>
                                <td>B</td>
                                <td>20¢</td>
                                <td>15¢</td>
                                <td style="color: var(--success);">+5¢</td>
                            </tr>
                            <tr>
                                <td>C</td>
                                <td>20¢</td>
                                <td>10¢</td>
                                <td style="color: var(--success);">+10¢</td>
                            </tr>
                            <tr>
                                <td>D</td>
                                <td>20¢</td>
                                <td>10¢</td>
                                <td style="color: var(--success);">+10¢</td>
                            </tr>
                            <tr>
                                <td>E</td>
                                <td>20¢</td>
                                <td>5¢</td>
                                <td style="color: var(--success);">+15¢</td>
                            </tr>
                        </table>
                    </div>
                    <p>우승후보: 큰 저평가 (-40¢)<br>언더독: 약간 고평가 (+5~15¢)</p>
                </div>
            </div>

            <h4>진짜 문제: 우승후보에 대한 고립된 NO 토큰</h4>

            <div class="box box-danger">
                <span class="box-title">100/n% (20% 초기) 사용 시</span>
                <ul>
                    <li>우승후보 YES = 20¢ (매우 저평가) → 트레이더 매수 → 제작자 싸게 매도</li>
                    <li>우승후보 NO = 80¢ (매우 고평가) → 아무도 안 삼 → 제작자 고립됨</li>
                </ul>
                <p>우승후보가 이기면, 제작자는 가치 없는 80¢ NO 토큰만 보유하게 됩니다.</p>
            </div>

            <h4>결론: 둘 다 문제를 해결하지 못함</h4>

            <div class="box box-highlight">
                <span class="box-title">100/n%는 하나의 문제를 다른 문제로 바꿀 뿐임</span>
                <ul>
                    <li>✅ 언더독이 공정 가치에 더 가깝게 책정됨</li>
                    <li>❌ 우승후보가 50%일 때보다 더 저평가됨</li>
                    <li>❌ 우승후보에 대한 비싼 NO 토큰(80¢)이 팔리지 않음</li>
                </ul>
                <p><strong>손실을 최소화하는지는 거래 패턴에 달려 있습니다.</strong></p>
            </div>

            <h4>진정한 해결책:</h4>
            <ol>
                <li><strong>CTF 다중 결과</strong> - 재고 고립 없음 (병합 가능)</li>
                <li><strong>마켓 메이커</strong> - 전문가가 재고 위험 감수</li>
                <li><strong>초기 플랫폼 유동성 없음</strong> - 시장이 먼저 가격을 발견하게 함</li>
                <li><strong>손실을 부트스트랩 비용으로 감수</strong> - 비즈니스의 일부</li>
            </ol>
        </section>

        <!-- Section 1.3: Liquidity Provision -->
        <section id="liquidity-provision" class="part-1-section">
            <h3><span class="section-num part-1">1.3</span>유동성 공급</h3>

            <h4>부트스트랩 문제</h4>

            <div class="diagram">
                <div class="diagram-title">유동성 부트스트랩 사이클</div>
                <div style="text-align: center; padding: 1.5rem; font-family: var(--font-mono); line-height: 1.8;">
                    유동성 없음 → 거래 없음 → 수수료 없음 → LP 유입 안 됨<br>
                    ↓<br>
                    <strong>플랫폼이 사이클을 깨야 함</strong><br>
                    ↓<br>
                    플랫폼이 유동성 공급 → 거래 시작 →<br>
                    수수료 발생 → 거래량 증명 → 외부 LP 참여
                </div>
            </div>

            <h4>누가 유동성을 공급하는가?</h4>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>공급자</th>
                            <th>현실</th>
                            <th>언제</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>무작위 트레이더</td>
                            <td>빈 시장에 오지 않음</td>
                            <td>초기에는 절대 없음</td>
                        </tr>
                        <tr>
                            <td>전문 MM</td>
                            <td>검증된 고거래량 시장에만 참여</td>
                            <td>거래량이 확립된 후</td>
                        </tr>
                        <tr>
                            <td><strong>플랫폼 자체</strong></td>
                            <td><strong>새로운 시장을 부트스트랩해야 함</strong></td>
                            <td><strong>첫날부터</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h4>균형 포지션 전략</h4>

            <pre
                style="font-size: 0.85rem; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px; margin: 1rem 0;">$1000 유동성으로 5개 결과 시장의 경우:

균등 분할: 시장당 $200

각 시장에 대해 (20% YES / 80% NO):
- 200 YES @ $0.20 = $40
- 200 NO @ $0.80 = $160
- 합계: $200 → 200 YES + 200 NO (균형)

A가 이길 경우:
- A: 200 YES × $1 = $200
- B: 200 NO × $1 = $200
- C: 200 NO × $1 = $200
- D: 200 NO × $1 = $200
- E: 200 NO × $1 = $200

반환: $1000 ✓ (균형 상태일 때 본전)</pre>

            <h4>적은 유동성 문제</h4>

            <div class="box box-warning">
                <span class="box-title">$500 유동성은 충분하지 않습니다</span>
                <ul>
                    <li>넓은 스프레드 (나쁜 가격)</li>
                    <li>작은 거래에도 높은 슬리피지</li>
                    <li>대량 주문 실행 불가</li>
                    <li>나쁜 사용자 경험</li>
                </ul>
            </div>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>유동성 수준</th>
                            <th>거래 품질</th>
                            <th>사용자 경험</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>시장당 $500</td>
                            <td>나쁨</td>
                            <td>좌절스러움, 큰 슬리피지</td>
                        </tr>
                        <tr>
                            <td>시장당 $5,000</td>
                            <td>보통</td>
                            <td>소액 트레이더에게 허용 가능</td>
                        </tr>
                        <tr>
                            <td>시장당 $50,000+</td>
                            <td>좋음</td>
                            <td>전문가 수준</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 1.4: Stuck Inventory Problem -->
        <section id="stuck-inventory" class="part-1-section">
            <h3><span class="section-num part-1">1.4</span>재고 고립 문제</h3>

            <h4>핵심 문제</h4>

            <div class="box box-danger">
                <span class="box-title">치명적인 문제</span>
                Grouped Binary 시장에서 LP는 아무도 사려 하지 않는 가치 없는 토큰을 떠안게 될 수 있습니다.
            </div>

            <pre
                style="font-size: 0.85rem; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px; margin: 1rem 0;">초기: 시장 A 20% YES / 80% NO
제작자 보유: 200 YES + 200 NO

시간 경과... A가 우승후보가 됨 (80% YES):

트레이더: "A의 YES를 사고 싶어!"
제작자: YES 매도, 행복 😊

트레이더: "A의 NO는 안 사, A가 이길 거니까!"
제작자: NO 매도 불가, 고립됨 😰

결과:
- YES: 200 → 50 (150개 매도, 좋음!)
- NO: 200 → 200 (아무도 안 삼, 고립!)

A가 이길 경우:
- 50 YES × $1 = $50
- 200 NO × $0 = $0
제작자 시작 $200, 종료 $50
손실: $150 ❌</pre>

            <h4>왜 교차 시장 매도가 도움이 안 되는가</h4>

            <p>패배하는 시장(B, C, D, E)에서 NO를 파는 것은 보상이 되지 않습니다:</p>

            <pre
                style="font-size: 0.85rem; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px; margin: 1rem 0;">B의 200 NO를 95¢에 매도 = $190 수취
하지만: A가 이기면, 구매자는 200 × $1 = $200를 받음

제작자는 $200 가치를 $190에 매도 = 손실

교차 시장 매도는 보상이 아니라 더 많은 손실을 추가합니다.</pre>

            <h4>CTF가 이를 해결함</h4>

            <div class="box box-success">
                <span class="box-title">CTF 다중 결과는 완전한 세트 병합을 허용함</span>
                <pre style="font-size: 0.85rem; background: transparent; margin: 0; padding: 0; color: inherit;">100 A + 100 B + 100 C + 100 D + 100 E → $100 USDC

상대방 불필요!
언제든지 병합을 통해 탈출 가능.
재고 고립 문제 없음.</pre>
            </div>

            <h4>LP를 위한 최악의 시나리오</h4>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>시나리오</th>
                            <th>수수료 수입</th>
                            <th>재고 손실</th>
                            <th>총 손실</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>최상의 경우</td>
                            <td>$500</td>
                            <td>$100</td>
                            <td style="color: var(--success);">+$500 수익</td>
                        </tr>
                        <tr>
                            <td>평균</td>
                            <td>$200</td>
                            <td>$350</td>
                            <td>-$150 (15%)</td>
                        </tr>
                        <tr>
                            <td>나쁜 경우</td>
                            <td>$75</td>
                            <td>$400</td>
                            <td>-$325 (32.5%)</td>
                        </tr>
                        <tr>
                            <td style="color: var(--danger);"><strong>최악의 경우</strong></td>
                            <td>$75</td>
                            <td>$860</td>
                            <td style="color: var(--danger);"><strong>-$785 (78.5%)</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
        <!-- Section 1.5: Market Makers -->
        <section id="market-makers" class="part-1-section">
            <h3><span class="section-num part-1">1.5</span>마켓 메이커 (MM)</h3>

            <h4>MM이 수익을 내는 방법</h4>

            <div class="grid-2">
                <div class="card">
                    <h4>1. 스프레드 (싸게 사서 비싸게 팔기)</h4>
                    <pre
                        style="font-size: 0.85rem; margin: 0; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px;">MM 주문 게시:
YES 매수 @ 49¢
YES 매도 @ 51¢

양쪽이 체결될 때:
- 트레이더 A가 YES 매수 @ 51¢ → MM 51¢ 수취
- 트레이더 B가 YES 매도 @ 49¢ → MM 49¢ 지불

MM 수익: 51¢ - 49¢ = 주당 2¢
10,000주 거래 시: 수익 = </pre>
                </div>

                <div class="card">
                    <h4>2. 수수료 리베이트</h4>
                    <pre
                        style="font-size: 0.85rem; margin: 0; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px;">Taker (주문 체결자): 2% 수수료 지불
Maker (주문 제공자): 0.5% 리베이트 수취

MM은 항상 주문을 제공함 → 모든 거래에서
리베이트 획득</pre>
                </div>
            </div>

            <div class="grid-2" style="margin-top: 1rem;">
                <div class="card">
                    <h4>3. 고빈도 조정</h4>
                    <pre
                        style="font-size: 0.85rem; margin: 0; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px;">가격이 오르는 중?
→ 매수 주문 취소 (비싸게 사는 것 방지)
→ 매도 가격 인상 (더 비싸게 팔기)

아마추어 LP: 매시간 업데이트 → 손해 봄
프로 MM: 매초 업데이트 → 스프레드 포착</pre>
                </div>

                <div class="card">
                    <h4>4. 시장 간 헤징</h4>
                    <pre
                        style="font-size: 0.85rem; margin: 0; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px;">상관관계가 있는 시장:
- "Chiefs 슈퍼볼 우승" (YES @ 25¢)
- "Mahomes MVP 수상" (YES @ 30¢)

MM은 Chiefs YES 매도, Mahomes YES 매수 (헤지)
순 노출: ~0
하지만: 스프레드 수익은 유지!</pre>
                </div>
            </div>

            <h4>MM 수익 공식</h4>

            <div class="box box-highlight">
                <pre style="font-size: 0.9rem; background: transparent; margin: 0; padding: 0; color: inherit;">MM 수익 = 스프레드 수입
          + 수수료 리베이트
          + 차익거래 이익
          - 재고 손실
          - 운영 비용</pre>
            </div>

            <h4>Nostra에 MM을 유치하는 방법</h4>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>방법</th>
                            <th>설명</th>
                            <th>플랫폼 비용</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>월간 수수료 지급</td>
                            <td>유동성 공급에 월 -10K</td>
                            <td>고정적, 예측 가능</td>
                        </tr>
                        <tr>
                            <td>수수료 리베이트</td>
                            <td>MM이 거래의 0.5% 획득</td>
                            <td>수익 감소</td>
                        </tr>
                        <tr>
                            <td>수익 공유</td>
                            <td>거래 수수료의 50%</td>
                            <td>가변적</td>
                        </tr>
                        <tr>
                            <td>토큰 인센티브</td>
                            <td>유동성에 대해 NOSTRA 토큰 지급</td>
                            <td>토큰 희석</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h4>핵심 통찰: Polymarket 모델</h4>

            <div class="box box-highlight">
                <span class="box-title">Polymarket은 공개 LP UI가 없습니다</span>
                <p>유동성 출처:</p>
                <ul>
                    <li>전문 MM (API를 통해, UI 아님)</li>
                    <li>Polymarket 내부 (숨겨짐, 무대 뒤에서)</li>
                    <li>트레이더들의 지정가 주문</li>
                </ul>
                <p>일반 사용자는 그저 거래할 뿐입니다. UI를 통해 "유동성을 공급"하지 않습니다.</p>
            </div>
        </section>

        <!-- Section 1.6: Fee Structure -->
        <section id="fee-structure" class="part-1-section">
            <h3><span class="section-num part-1">1.6</span>수수료 구조</h3>

            <h4>수수료 분배 모델</h4>

            <div class="diagram">
                <div class="diagram-title">수수료 흐름</div>
                <div style="text-align: center; padding: 1.5rem; font-family: var(--font-mono); line-height: 1.8;">
                    LP가 유동성 공급<br>↓<br>
                    트레이더가 거래 가능<br>↓<br>
                    트레이더가 수수료 지불<br>↓<br>
                    수수료가 LP에게 수익으로 전달<br>↓<br>
                    LP가 위험에 대해 보상받음<br>↓<br>
                    더 많은 LP 유입 → 더 많은 유동성
                </div>
            </div>

            <h4>제안된 수수료 구조</h4>

            <pre
                style="font-size: 0.85rem; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px; margin: 1rem 0;">거래: 
수수료: 2% = .00

분배:
├── LP (유동성 공급자): .50 (75%)
└── 플랫폼 (Nostra):    /opt/homebrew/bin/zsh.50 (25%)</pre>

            <h4>LP 수익률 계산</h4>

            <pre
                style="font-size: 0.85rem; padding: 1rem; background: #0f172a; color: #fef08a; border-radius: 6px; margin: 1rem 0;">LP 공급: ,000 유동성
시장 거래량: 월 ,000
수수료율: 2%
LP 지분: 75%

LP 수익:
,000 × 2% × 75% = /월

LP 수익률:
 / ,000 = 월 75% APY 🔥

(높은 수익률은 재고 위험을 보상함)</pre>

            <h4>트레이드오프</h4>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>수수료 수준</th>
                            <th>LP 수익률</th>
                            <th>거래 활동</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>높음 (3%+)</td>
                            <td>높음</td>
                            <td>낮음 (거래 비용 비쌈)</td>
                        </tr>
                        <tr>
                            <td>중간 (2%)</td>
                            <td>중간</td>
                            <td>중간</td>
                        </tr>
                        <tr>
                            <td>낮음 (0.5%)</td>
                            <td>낮음</td>
                            <td>높음 (거래 비용 저렴)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h4>수수료가 손실을 커버할 수 있는가?</h4>

            <div class="box box-warning">
                <span class="box-title">항상 그렇지는 않음</span>
                <p>거래량이 적고 시장이 한 방향으로 급격히 움직일 경우:</p>
                <ul>
                    <li>수수료 수입: 적음</li>
                    <li>재고 손실: 큼</li>
                    <li>순결과: 상당한 손실</li>
                </ul>
                <p>수수료는 도움이 되지만 수익을 보장하지는 않습니다.</p>
            </div>
        </section>

        <!-- Section 1.7: AMM vs Order Book -->
        <section id="amm-vs-orderbook" class="part-1-section">
            <h3><span class="section-num part-1">1.7</span>AMM vs 오더북</h3>

            <h4>근본적인 차이점</h4>

            <div class="grid-2">
                <div class="card">
                    <h4><span class="label label-accent">오더북</span></h4>
                    <ul>
                        <li>구매자와 판매자가 직접 만남</li>
                        <li>지정가 주문 (Limit Orders)</li>
                        <li>스프레드가 좁음 (유동성이 충분할 때)</li>
                        <li>전문가에게 친숙함</li>
                        <li><strong>Nostra의 선택 (CLOB)</strong></li>
                    </ul>
                </div>
                <div class="card">
                    <h4><span class="label label-purple">AMM (CPMM)</span></h4>
                    <ul>
                        <li>풀(Pool)과 거래함</li>
                        <li>알고리즘 가격 결정 (x*y=k)</li>
                        <li>항상 유동성 존재 (가격에 상관없이)</li>
                        <li>초보자에게 쉬움 (Uniswap 스타일)</li>
                        <li>예측 시장에서는 자본 효율성 낮음</li>
                    </ul>
                </div>
            </div>

            <h4>왜 오더북인가?</h4>

            <div class="box box-highlight">
                <span class="box-title">예측 시장에는 오더북이 더 낫습니다</span>
                <p>예측 시장의 결과는 0 또는 1입니다. AMM은 가격이 0이나 1에 가까워질수록 유동성을 제공하기 위해 막대한 자본을 요구합니다 (LSR - Logarithmic Scoring Rule 등 복잡한 수학 필요).</p>
                <p>오더북은 사용자가 원하는 가격에 정확히 주문을 낼 수 있어 가격 발견이 더 효율적입니다.</p>
            </div>
        </section>

        <!-- Section 1.8: Platform Economics -->
        <section id="platform-economics" class="part-1-section">
            <h3><span class="section-num part-1">1.8</span>플랫폼 경제학</h3>

            <h4>수익 모델</h4>
            <ul class="impl-list">
                <li>
                    <span class="impl-number">1</span>
                    <div class="impl-content">
                        <strong>거래 수수료</strong>
                        <small>모든 거래의 2% (LP와 공유)</small>
                    </div>
                </li>
                <li>
                    <span class="impl-number">2</span>
                    <div class="impl-content">
                        <strong>상환 수수료</strong>
                        <small>당첨금 수령 시 1% (선택 사항)</small>
                    </div>
                </li>
                <li>
                    <span class="impl-number">3</span>
                    <div class="impl-content">
                        <strong>시장 생성 비용</strong>
                        <small>스팸 방지를 위한 소액의 비용</small>
                    </div>
                </li>
            </ul>
        </section>

        <!-- Section 1.9: Implementation Considerations -->
        <section id="implementation" class="part-1-section">
            <h3><span class="section-num part-1">1.9</span>구현 고려사항</h3>

            <h4>초기 런칭 전략</h4>
            <div class="box box-success">
                <span class="box-title">단계적 접근</span>
                <ol>
                    <li><strong>소수 정예 시장:</strong> 유동성을 집중시키기 위해 소수의 고품질 시장만 운영</li>
                    <li><strong>자체 유동성 공급:</strong> 초기에는 플랫폼이 직접 유동성 공급 (손실 감수)</li>
                    <li><strong>인센티브 프로그램:</strong> 초기 트레이더 및 LP에게 보상 제공</li>
                </ol>
            </div>
        </section>

        <!-- PART 2: MARKET MODELS -->
        <div class="part-divider">
            <h2>2부: 시장 모델</h2>
            <span class="part-subtitle">CTF 다중 결과 vs NegRisk 어댑터</span>
        </div>

        <!-- Section 2.1: Model Comparison -->
        <section id="model-comparison" class="part-2-section">
            <h3><span class="section-num part-2">2.1</span>모델 비교 개요</h3>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>특징</th>
                            <th>Grouped Binary (Nostra)</th>
                            <th>CTF 다중 결과</th>
                            <th>NegRisk (Polymarket)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>구조</strong></td>
                            <td>독립적인 바이너리 시장들</td>
                            <td>상호 배타적인 결과 세트</td>
                            <td>CTF 위에 변환 레이어 추가</td>
                        </tr>
                        <tr>
                            <td><strong>가격 합계</strong></td>
                            <td>제한 없음 (예: 250%)</td>
                            <td>항상 100% (또는 1.0)</td>
                            <td>항상 100% (차익거래 통해)</td>
                        </tr>
                        <tr>
                            <td><strong>유동성 효율성</strong></td>
                            <td><span class="label label-danger">낮음</span> (파편화됨)</td>
                            <td><span class="label label-warning">중간</span> (병합 가능)</td>
                            <td><span class="label label-success">높음</span> (단일 유동성 풀)</td>
                        </tr>
                        <tr>
                            <td><strong>복잡도</strong></td>
                            <td><span class="label label-success">낮음</span></td>
                            <td><span class="label label-warning">중간</span></td>
                            <td><span class="label label-danger">매우 높음</span></td>
                        </tr>
                        <tr>
                            <td><strong>사용자 경험</strong></td>
                            <td>직관적 (YES/NO)</td>
                            <td>약간 복잡함</td>
                            <td>최상 (주식 거래와 유사)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 2.2: Grouped Binary -->
        <section id="grouped-binary" class="part-2-section">
            <h3><span class="section-num part-2">2.2</span>Grouped Binary 모델 (Nostra)</h3>
            <p>현재 Nostra가 사용하는 모델입니다. 각 선택지(예: "한국 우승")는 독립적인 YES/NO 시장입니다.</p>

            <div class="box box-warning">
                <span class="box-title">주요 문제점: 재고 고립 (Stuck Inventory)</span>
                <p>앞서 1.4절에서 설명한 바와 같이, 우승후보의 NO 토큰이 팔리지 않아 LP가 손실을 입는 구조적 문제가 있습니다.</p>
            </div>
        </section>

        <!-- Section 2.3: CTF Multi-Outcome -->
        <section id="ctf-multi" class="part-2-section">
            <h3><span class="section-num part-2">2.3</span>CTF 다중 결과 모델</h3>
            <p>Gnosis Conditional Tokens Framework (CTF)의 기본 기능을 사용합니다.</p>

            <h4>작동 방식</h4>
            <ul class="impl-list">
                <li>
                    <span class="impl-number">1</span>
                    <div class="impl-content">
                        <strong>분할 (Split)</strong>
                        <small>1 USDC → [A, B, C, D] 모든 결과 토큰 1개씩 생성</small>
                    </div>
                </li>
                <li>
                    <span class="impl-number">2</span>
                    <div class="impl-content">
                        <strong>거래 (Trade)</strong>
                        <small>A가 이길 것 같으면 B, C, D를 팔고 A만 보유</small>
                    </div>
                </li>
                <li>
                    <span class="impl-number">3</span>
                    <div class="impl-content">
                        <strong>병합 (Merge)</strong>
                        <small>[A, B, C, D] 세트를 모으면 다시 1 USDC로 교환 가능</small>
                    </div>
                </li>
            </ul>

            <div class="box box-success">
                <span class="box-title">장점</span>
                <p>모든 결과를 모으면 언제든지 1달러로 바꿀 수 있으므로, "재고 고립" 문제가 해결됩니다. 내가 가진 B, C, D 토큰은 누군가에게는 A 토큰을 만들기 위한 재료가 됩니다.</p>
            </div>
        </section>

        <!-- Section 2.4: NegRisk Adapter -->
        <section id="negrisk" class="part-2-section">
            <h3><span class="section-num part-2">2.4</span>NegRisk 어댑터 (Polymarket)</h3>
            <p>Polymarket이 개발한 "Negative Risk" 기술은 CTF 위에 사용자 편의성을 더한 레이어입니다.</p>

            <h4>사용자 경험의 마법</h4>
            <div class="grid-2">
                <div class="card">
                    <h4>CTF만 사용할 때</h4>
                    <p>사용자가 "A 매수"를 하려면:</p>
                    <ol>
                        <li>USDC로 [A,B,C,D] 분할</li>
                        <li>B, C, D를 시장에 매도</li>
                        <li>A만 남음</li>
                    </ol>
                    <p style="color: var(--danger);">복잡하고 가스비가 많이 듦</p>
                </div>
                <div class="card">
                    <h4>NegRisk 사용 시</h4>
                    <p>사용자가 "A 매수"를 하려면:</p>
                    <ol>
                        <li>그냥 USDC로 A를 산다 (끝)</li>
                    </ol>
                    <p style="color: var(--success);">백그라운드에서 자동 변환</p>
                </div>
            </div>
        </section>

        <!-- Section 2.5: NegRisk Conversion Mechanics -->
        <section id="negrisk-conversion" class="part-2-section">
            <h3><span class="section-num part-2">2.5</span>NegRisk 변환 메커니즘</h3>

            <h4>핵심 아이디어: NO = 나머지 모든 YES</h4>
            <p>"A가 아니다(NO)"라는 것은 "B 또는 C 또는 D다(YES)"와 같습니다.</p>

            <div class="box box-highlight">
                <pre style="font-size: 1rem; text-align: center; margin: 0; background: transparent; color: inherit;">1 A_NO = 1 B_YES + 1 C_YES + 1 D_YES</pre>
            </div>

            <p>이 등식을 이용해 유동성을 하나로 통합합니다.</p>

            <h4>실전 예시: ,000 유동성, 10개 국가</h4>
            <p>트레이더들이 순차적으로 씩 매수할 때 어떤 일이 일어나는지 추적해 봅시다.</p>

            <div class="diagram">
                <div class="diagram-title">초기 설정</div>
                <pre
                    style="font-size: 0.85rem; margin: 0; padding: 1rem; background: #1e293b; color: #e2e8f0; border-radius: 6px;">
10개 국가: 스페인, 프랑스, 브라질, 아르헨티나, 잉글랜드,
           독일, 이탈리아, 포르투갈, 네덜란드, 벨기에

초기 가격: 각 10¢ YES / 90¢ NO (10% 확률)
마켓 메이커: 국가당 ,000 → 각 1,000 (YES+NO) 쌍</pre>
            </div>

            <h5 style="margin-top: 1.5rem;">Grouped Binary: 10번 거래 후 (주로 스페인)</h5>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>국가</th>
                            <th>YES 잔량</th>
                            <th>NO 잔량</th>
                            <th>상태</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>스페인</strong></td>
                            <td style="color: var(--danger);">312</td>
                            <td>1,000</td>
                            <td><span class="label label-danger">688 NO 고립됨!</span></td>
                        </tr>
                        <tr>
                            <td>프랑스</td>
                            <td>800</td>
                            <td>1,000</td>
                            <td><span class="label label-warning">200 과잉 NO</span></td>
                        </tr>
                        <tr>
                            <td>브라질</td>
                            <td>900</td>
                            <td>1,000</td>
                            <td><span class="label label-warning">100 과잉 NO</span></td>
                        </tr>
                        <tr>
                            <td>기타...</td>
                            <td>1,000</td>
                            <td>1,000</td>
                            <td><span class="label label-success">균형</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="box box-danger" style="margin-top: 1rem;">
                <span class="box-title">문제: 스페인 유동성 위기</span>
                <pre
                    style="font-size: 0.85rem; margin: 0.5rem 0; padding: 1rem; background: #450a0a; color: #fecaca; border-radius: 6px;">
거래 11:  스페인 YES 매수...

스페인 YES 312개만 남음!
가격 급등: 10¢ → 15¢ → 20¢ (슬리피지)
로 100개 대신 50개만 매수 가능

반면: 688 스페인 NO 토큰은 쓸모없이 방치됨 💀
마켓 메이커는 NO를 다른 국가로 옮길 수 없음</pre>
            </div>

            <h5 style="margin-top: 1.5rem;">NegRisk: 마켓 메이커 리밸런싱</h5>
            <div class="box box-highlight">
                <span class="box-title">NegRisk 변환 마법</span>
                <pre
                    style="font-size: 0.85rem; margin: 0.5rem 0; padding: 1rem; background: #1e1b4b; color: #c7d2fe; border-radius: 6px;">
각 국가에서 200개의 과잉 NO를 가져옴:
• 200 스페인 NO + 200 프랑스 NO + 200 브라질 NO + ...
= 2,000개의 완전한 NO 세트 (각 국가당 하나씩)
= 10 NO 토큰 × 200 세트 = ,800 가치 (10 NO = )

변환 → ,800 USDC가 마켓 메이커에게 반환됨!</pre>
                <p style="margin-top: 0.75rem;">마켓 메이커는 ,800를 사용하여 500개의 새로운 스페인 (YES+NO) 쌍을 발행 → <strong>스페인 유동성
                        복구!</strong>
                </p>
            </div>

            <div class="grid-2" style="margin-top: 1rem;">
                <div class="card" style="border-left: 3px solid var(--danger);">
                    <h4>Grouped Binary 결과</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>스페인 YES 잔량: <strong style="color: var(--danger);">312</strong></li>
                        <li>슬리피지: <strong style="color: var(--danger);">높음</strong></li>
                        <li>과잉 NO: <strong>고립됨</strong></li>
                        <li>다음 트레이더 지불: <strong>+50% 더 비쌈</strong></li>
                    </ul>
                </div>
                <div class="card" style="border-left: 3px solid var(--success);">
                    <h4>NegRisk 결과</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>스페인 YES 잔량: <strong style="color: var(--success);">800</strong></li>
                        <li>슬리피지: <strong style="color: var(--success);">낮음</strong></li>
                        <li>과잉 NO: <strong>변환됨</strong></li>
                        <li>다음 트레이더 지불: <strong>정상 가격</strong></li>
                    </ul>
                </div>
            </div>

            <h4 style="margin-top: 2rem;">누가 리밸런싱을 수행하나요?</h4>
            <p>NegRisk 어댑터는 <strong>비허가형(permissionless)</strong>입니다. 누구나 변환 함수를 호출할 수 있습니다. 실제로는:</p>

            <div class="grid-2">
                <div class="card">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                        <span style="font-size: 1.25rem;">🤖</span>
                        <h4 style="margin: 0;">차익거래 봇</h4>
                    </div>
                    <p style="font-size: 0.875rem;">자동화된 봇이 가격 불일치를 모니터링합니다. YES 가격의 합이 100%가 아닐 때, 변환을 통해 수익을 내며 부수적으로 유동성을 리밸런싱합니다.</p>
                </div>
                <div class="card">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                        <span style="font-size: 1.25rem;">🏦</span>
                        <h4 style="margin: 0;">전문 마켓 메이커</h4>
                    </div>
                    <p style="font-size: 0.875rem;">Wintermute, GSR 같은 기업들은 정교한 전략을 실행합니다. 그들은 좁은 스프레드를 유지하기 위해 NegRisk를 사용하여 재고를 적극적으로 관리합니다.</p>
                </div>
                <div class="card">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                        <span style="font-size: 1.25rem;">⚙️</span>
                        <h4 style="margin: 0;">프로토콜 자동화</h4>
                    </div>
                    <p style="font-size: 0.875rem;">일부 프로토콜은 재고가 임계값을 넘어가면 자동으로 리밸런싱하는 키퍼(Keeper) 봇을 운영합니다 (거래 수수료로 자금 조달).</p>
                </div>
                <div class="card">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                        <span style="font-size: 1.25rem;">💡</span>
                        <h4 style="margin: 0;">스마트 트레이더</h4>
                    </div>
                    <p style="font-size: 0.875rem;">고급 사용자는 UI나 스크립트를 통해 직접 변환하여 차익을 얻을 수 있습니다.</p>
                </div>
            </div>
        </section>

        <!-- Section 2.6: NegRisk Architecture -->
        <section id="negrisk-arch" class="part-2-section">
            <h3><span class="section-num part-2">2.6</span>NegRisk 아키텍처</h3>

            <div style="margin-bottom: 2rem;">
                <p>참조 구현 (Polymarket):
                    <a href="https://github.com/Polymarket/neg-risk-ctf-adapter" target="_blank"
                        style="color: var(--accent);">GitHub: Polymarket/neg-risk-ctf-adapter →</a>
                </p>
                <p style="font-size: 0.8125rem; color: var(--text-muted); margin-top: 0.5rem;">
                    포함: NegRiskAdapter, NegRiskOperator, NegRiskCtfExchange, WrappedCollateral, Vault, FeeModule
                </p>
            </div>

            <h4>아키텍처 레이어</h4>
            <div class="arch-layer">
                <div class="arch-layer-title">사용자 인터페이스</div>
                <div class="arch-layer-content">
                    <div class="func">"내 스페인 YES를 프랑스 YES로 변환"</div>
                </div>
            </div>

            <div class="arch-arrow">↓</div>

            <div class="arch-layer">
                <div class="arch-layer-title">NegRisk 어댑터</div>
                <div class="arch-layer-content">
                    <div class="func">splitPosition()</div>
                    <div class="func">mergePositions()</div>
                    <div class="func">convertPosition()</div>
                </div>
                <p style="text-align: center; margin-top: 0.75rem; font-size: 0.9rem; color: var(--text-muted);">
                    핵심: USDC ↔ NO 토큰 ↔ YES 토큰 변환</p>
            </div>

            <div class="arch-arrow">↓</div>

            <div class="arch-layer">
                <div class="arch-layer-title">Grouped Binary 시장</div>
                <p style="text-align: center; font-size: 0.9rem; color: var(--text-muted);">
                    스페인 YES/NO | 프랑스 YES/NO | 브라질 YES/NO | ...<br>
                    모두 <code>negRiskMarketId</code>로 연결됨
                </p>
            </div>

            <div class="arch-arrow">↓</div>

            <div class="arch-layer">
                <div class="arch-layer-title">Conditional Tokens Framework (CTF)</div>
                <p style="text-align: center; font-size: 0.9rem; color: var(--text-muted);">모든 토큰 작업의 기본 레이어</p>
            </div>

            <h4>주요 컨트랙트</h4>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>컨트랙트</th>
                            <th>목적</th>
                            <th>Nostra 보유?</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>NegRiskAdapter</strong></td>
                            <td>핵심 변환 로직 (NO → YES)</td>
                            <td><span class="label label-danger">아니오</span></td>
                        </tr>
                        <tr>
                            <td><strong>NegRiskOperator</strong></td>
                            <td>관리자 기능, 오라클 통합</td>
                            <td><span class="label label-danger">아니오</span></td>
                        </tr>
                        <tr>
                            <td><strong>WrappedCollateral</strong></td>
                            <td>내부 회계용 Wrapped USDC</td>
                            <td><span class="label label-danger">아니오</span></td>
                        </tr>
                        <tr>
                            <td>ConditionalTokens (CTF)</td>
                            <td>기본 토큰 프레임워크</td>
                            <td><span class="label label-success">예</span></td>
                        </tr>
                        <tr>
                            <td>MarketFactory</td>
                            <td>바이너리 시장 생성</td>
                            <td><span class="label label-success">예</span></td>
                        </tr>
                        <tr>
                            <td>CTFExchange</td>
                            <td>오더북 트레이딩</td>
                            <td><span class="label label-success">예</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 2.7: Implementation Options -->
        <section id="implementation-options" class="part-2-section">
            <h3><span class="section-num part-2">2.7</span>구현 옵션</h3>

            <h4>Nostra가 NegRisk를 구현하기 위해 필요한 것</h4>
            <ul class="impl-list">
                <li>
                    <span class="impl-number">1</span>
                    <div class="impl-content">
                        <strong>WrappedCollateral.sol</strong>
                        <small>내부 회계를 위한 USDC의 ERC20 래퍼</small>
                    </div>
                    <span class="difficulty difficulty-easy">쉬움</span>
                </li>
                <li>
                    <span class="impl-number">2</span>
                    <div class="impl-content">
                        <strong>NegRiskAdapter.sol</strong>
                        <small>핵심 변환 로직: splitPosition, mergePositions, convertPosition</small>
                    </div>
                    <span class="difficulty difficulty-hard">어려움</span>
                </li>
                <li>
                    <span class="impl-number">3</span>
                    <div class="impl-content">
                        <strong>NegRiskOperator.sol</strong>
                        <small>시장 그룹 관리, 바이너리 시장 연결</small>
                    </div>
                    <span class="difficulty difficulty-medium">중간</span>
                </li>
                <li>
                    <span class="impl-number">4</span>
                    <div class="impl-content">
                        <strong>데이터베이스: negRiskMarketId 필드</strong>
                        <small>같은 그룹의 시장 연결</small>
                    </div>
                    <span class="difficulty difficulty-easy">쉬움</span>
                </li>
                <li>
                    <span class="impl-number">5</span>
                    <div class="impl-content">
                        <strong>API: /api/negrisk/convert 엔드포인트</strong>
                        <small>프론트엔드의 변환 요청 처리</small>
                    </div>
                    <span class="difficulty difficulty-medium">중간</span>
                </li>
                <li>
                    <span class="impl-number">6</span>
                    <div class="impl-content">
                        <strong>프론트엔드: 포지션 변환 UI</strong>
                        <small>같은 그룹 내 결과 간 변환 버튼</small>
                    </div>
                    <span class="difficulty difficulty-medium">중간</span>
                </li>
            </ul>

            <h4>예상 소요 시간</h4>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>컴포넌트</th>
                            <th>시간</th>
                            <th>복잡도</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>스마트 컨트랙트 (1-3)</td>
                            <td>2-3주</td>
                            <td>높음 (보안 중요)</td>
                        </tr>
                        <tr>
                            <td>백엔드 API (4-5)</td>
                            <td>3-5일</td>
                            <td>중간</td>
                        </tr>
                        <tr>
                            <td>프론트엔드 UI (6)</td>
                            <td>3-5일</td>
                            <td>중간</td>
                        </tr>
                        <tr>
                            <td>테스트 및 감사</td>
                            <td>2-4주</td>
                            <td>매우 중요</td>
                        </tr>
                        <tr>
                            <td><strong>총계</strong></td>
                            <td><strong>6-10주</strong></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="box box-warning">
                <span class="box-title">대안: 차익거래 봇</span>
                <p>NegRisk를 구현하기 전에, 정말 필요한지 고려해보세요. 현재의 차익거래 봇으로도 훨씬 간단한 구현으로 경제적 포지션 균형을 맞출 수 있습니다.</p>
                <p><strong>언제 NegRisk를 구현해야 할까요?</strong></p>
                <ul>
                    <li>변환 수요가 복잡성을 정당화할 만큼 거래량이 많을 때</li>
                    <li>재고 고립에 대한 사용자 불만이 있을 때</li>
                    <li>Polymarket 수준의 기능에 대한 경쟁 압력이 있을 때</li>
                </ul>
            </div>
        </section>

        <!-- PART 3: CHAINLINK INTEGRATION -->
        <div class="part-divider">
            <h2>3부: 체인링크 오라클 통합</h2>
            <span class="part-subtitle">탈중앙화된 시장 해결</span>
        </div>

        <!-- Section 3.1: Why Chainlink -->
        <section id="why-chainlink" class="part-3-section">
            <h3><span class="section-num part-3">3.1</span>시장 해결을 위한 체인링크</h3>

            <h4>현재 상태: 수동 해결</h4>
            <div class="box box-danger">
                <span class="box-title">수동 해결의 문제점</span>
                <ul>
                    <li><strong>중앙화된 신뢰:</strong> 관리자가 결과를 조작할 수 있음</li>
                    <li><strong>검증 불가능한 출처:</strong> 사용자는 플랫폼을 신뢰해야 함</li>
                    <li><strong>인적 오류 위험:</strong> 수동 프로세스는 실수하기 쉬움</li>
                </ul>
            </div>

            <h4>체인링크 솔루션</h4>
            <div class="box box-success">
                <span class="box-title">체인링크 해결의 이점</span>
                <ul>
                    <li><strong>탈중앙화 오라클 네트워크:</strong> 다수의 노드가 데이터 검증</li>
                    <li><strong>검증 가능한 데이터 소스:</strong> 진본성에 대한 암호학적 증명</li>
                    <li><strong>무신뢰 자동화:</strong> 사람의 개입 불필요</li>
                    <li><strong>업계 표준:</strong> 입증된 보안 기록</li>
                </ul>
            </div>

            <div style="margin: 2rem 0; text-align: center;">
                <img src="images/chainlink-architecture.png" alt="Chainlink Architecture"
                    style="max-width: 100%; border-radius: 12px; border: 1px solid var(--border); box-shadow: var(--shadow-md);">
                <p style="font-size: 0.8125rem; color: var(--text-muted); margin-top: 0.5rem;">체인링크 탈중앙화 오라클 네트워크 (DON)
                    아키텍처</p>
            </div>
        </section>

        <!-- Section 3.2: Getting Started -->
        <section id="chainlink-setup" class="part-3-section">
            <h3><span class="section-num part-3">3.2</span>체인링크 시작하기</h3>
            <p>체인링크를 통합하려면 다음 단계가 필요합니다:</p>
            <ol>
                <li><strong>LINK 토큰 확보:</strong> 오라클 서비스 비용 지불을 위해 필요합니다.</li>
                <li><strong>구독 생성:</strong> Chainlink Functions 또는 Automation을 위한 구독을 생성하고 LINK를 충전합니다.</li>
                <li><strong>컨트랙트 등록:</strong> Consumer 컨트랙트를 구독에 추가합니다.</li>
            </ol>
        </section>

        <!-- Section 3.3: Handling Long-tail Markets -->
        <section id="long-tail-markets" class="part-3-section">
            <h3><span class="section-num part-3">3.3</span>롱테일 및 비정형 시장 처리</h3>
            <p><em>"지역 '우리들의 발라드' 노래자랑 우승자는 누구인가?"</em>와 같은 틈새 시장을 해결하고 싶다면 어떻게 해야 할까요?</p>

            <h4>시나리오 A: 온라인에 데이터가 존재함</h4>
            <div class="box box-highlight">
                <span class="box-title">솔루션: Chainlink Functions</span>
                <p>결과가 공식 웹사이트, 뉴스 기사 또는 위키피디아에 게시된 경우:</p>
                <ol>
                    <li><strong>개발자</strong>가 우승자 이름을 스크래핑하는 자바스크립트 스크립트를 작성합니다 (예: <code>div.winner</code>에서).
                    </li>
                    <li><strong>체인링크 노드 (DON)</strong>가 이 스크립트를 실행하고 데이터를 가져옵니다.</li>
                    <li><strong>합의</strong>에 도달하면 결과("김철수")가 온체인으로 전달됩니다.
                    </li>
                </ol>
                <p style="color: #166534; font-weight: 500; margin-top: 0.5rem;">✓ 최적: 검증 가능한 디지털 데이터 소스.</p>
            </div>

            <h4>시나리오 B: 디지털 발자국 없음</h4>
            <div class="box box-danger">
                <span class="box-title">한계점</span>
                <p>대회가 너무 작아서 뉴스에도 안 나오고 웹사이트도 없다면, <strong>체인링크는 해결할 수 없습니다</strong>. 체인링크는 현실 세계의 데이터를 배달하는 서비스이지, 진실을
                    창조하는
                    존재가 아닙니다.</p>
            </div>

            <h4>대안: UMA (낙관적 오라클)</h4>
            <p>API가 없는 비정형 롱테일 시장의 경우, <strong>UMA</strong>는 사람이 검증하는 솔루션을 제공합니다 (Polymarket 사용).</p>

            <div class="grid-2">
                <div class="card">
                    <h4>UMA 작동 방식</h4>
                    <ol style="font-size: 0.875rem;">
                        <li><strong>제안:</strong> 누구나 "김철수가 우승했다"고 주장합니다.</li>
                        <li><strong>이의 제기 기간:</strong> 분쟁을 위한 창(예: 2시간)이 열립니다.</li>
                        <li><strong>확정:</strong> 이의가 없으면 답변이 수락됩니다.</li>
                        <li><strong>분쟁:</strong> 이의가 제기되면 토큰 보유자가 투표하여 진실을 결정합니다.</li>
                    </ol>
                </div>
                <div class="card">
                    <h4>장단점</h4>
                    <ul style="font-size: 0.875rem;">
                        <li><span style="color: #166534;">✓</span> 사람이 검증할 수 있는 모든 질문에 작동.</li>
                        <li><span style="color: #166534;">✓</span> API 불필요.</li>
                        <li><span style="color: #991b1b;">✗</span> 느림 (이의 제기 기간 필요).</li>
                        <li><span style="color: #991b1b;">✗</span> 더 복잡한 게임 이론.</li>
                    </ul>
                </div>
            </div>

            <div class="box box-warning">
                <span class="box-title">요약: 올바른 오라클 선택</span>
                <ul>
                    <li><strong>웹사이트/API 존재</strong> → <span class="label label-primary">Chainlink
                            Functions</span> (가장 깔끔하고 빠름)</li>
                    <li><strong>디지털 정보 없음</strong> → <span class="label label-warning">UMA (낙관적)</span> 또는
                        <span class="label label-danger">수동 관리자</span> (가장 저렴함)
                    </li>
                </ul>
            </div>
        </section>

        <!-- Section 3.4: Chainlink Products -->
        <section id="chainlink-products" class="part-3-section">
            <h3><span class="section-num part-3">3.4</span>체인링크 제품 개요</h3>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>제품</th>
                            <th>사용 사례</th>
                            <th>적합한 대상</th>
                            <th>비용</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Data Feeds</strong></td>
                            <td>가격 데이터 (BTC, ETH, 주식)</td>
                            <td>"BTC가 K를 넘을까?"</td>
                            <td><span class="label label-success">무료</span></td>
                        </tr>
                        <tr>
                            <td><strong>Functions</strong></td>
                            <td>커스텀 API 호출</td>
                            <td>스포츠 점수, 선거 결과</td>
                            <td>요청당 ~0.25 LINK</td>
                        </tr>
                        <tr>
                            <td><strong>Automation</strong></td>
                            <td>예약/조건부 실행</td>
                            <td>마감 시 자동 해결</td>
                            <td>실행당 ~0.1 LINK</td>
                        </tr>
                        <tr>
                            <td><strong>VRF</strong></td>
                            <td>검증 가능한 무작위성</td>
                            <td>복권 스타일 시장</td>
                            <td>요청당 ~0.25 LINK</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="grid-3">
                <div class="card">
                    <h4>Data Feeds</h4>
                    <p style="font-size: 0.875rem;">암호화폐, 원자재, 외환을 위한 실시간 위변조 방지 가격 데이터.</p>
                    <pre style="font-size: 0.75rem;">노드 → 집계 → 온체인
       ↓
컨트랙트가 가격 읽기
       ↓
비교 → 해결</pre>
                </div>
                <div class="card">
                    <h4>Functions</h4>
                    <p style="font-size: 0.875rem;">모든 API에서 데이터를 가져오기 위해 커스텀 자바스크립트 실행.</p>
                    <pre style="font-size: 0.75rem;">컨트랙트 → 요청 → DON
       ↓
자바스크립트 실행
       ↓
API 조회 → 반환</pre>
                </div>
                <div class="card">
                    <h4>Automation</h4>
                    <p style="font-size: 0.875rem;">일정이나 조건에 따라 컨트랙트 함수 자동 호출.</p>
                    <pre style="font-size: 0.75rem;">Upkeep 등록 → 모니터링
       ↓
조건 충족?
       ↓
performUpkeep()</pre>
                </div>
            </div>
        </section>

        <!-- Section 3.5: Resolution Architecture -->
        <section id="resolution-arch" class="part-3-section">
            <h3><span class="section-num part-3">3.5</span>해결 아키텍처</h3>

            <h4>현재 vs 제안된 흐름</h4>
            <div class="grid-2">
                <div class="card">
                    <h4>현재: 관리자 해결</h4>
                    <div class="flow-step">관리자 UI</div>
                    <div class="flow-arrow">↓</div>
                    <div class="flow-step">POST /api/admin/resolve</div>
                    <div class="flow-arrow">↓</div>
                    <div class="flow-step">서버 지갑 서명</div>
                    <div class="flow-arrow">↓</div>
                    <div class="flow-step final">reportPayouts() → 해결됨</div>
                    <p style="font-size: 0.8125rem; margin-top: 1rem; color: #991b1b;"><strong>관리자가 수동으로 승자 결정</strong>
                    </p>
                </div>
                <div class="card">
                    <h4>제안: 체인링크 해결</h4>
                    <div class="flow-step">시장 마감</div>
                    <div class="flow-arrow">↓</div>
                    <div class="flow-step">Chainlink Automation 트리거</div>
                    <div class="flow-arrow">↓</div>
                    <div class="flow-step">컨트랙트가 Price Feed 읽기</div>
                    <div class="flow-arrow">↓</div>
                    <div class="flow-step final">reportPayouts() → 해결됨</div>
                    <p style="font-size: 0.8125rem; margin-top: 1rem; color: #166534;"><strong>데이터 기반 자동 해결</strong></p>
                </div>
            </div>
        </section>

        <!-- Section 3.6: Smart Contract Integration -->
        <section id="smart-contracts" class="part-3-section">
            <h3><span class="section-num part-3">3.6</span>스마트 컨트랙트 통합</h3>

            <h4>Price Feed Resolver 예시</h4>
            <pre>
<span class="code-comment">// SPDX-License-Identifier: MIT</span>
<span class="code-keyword">pragma solidity</span> ^0.8.19;

<span class="code-keyword">import</span> "@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol";

<span class="code-keyword">contract</span> PriceFeedResolver {
    AggregatorV3Interface internal priceFeed;
    IConditionalTokens public ctf;

    <span class="code-keyword">struct</span> PriceMarket {
        bytes32 questionId;
        uint256 threshold;      <span class="code-comment">// 8자리 소수점 가격 임계값</span>
        bool resolveAbove;      <span class="code-comment">// true = 가격 > 임계값이면 YES 승리</span>
        uint256 deadline;
        bool resolved;
    }

    mapping(bytes32 => PriceMarket) public markets;

    <span class="code-keyword">function</span> resolveMarket(bytes32 questionId) <span class="code-keyword">external</span> {
        PriceMarket storage market = markets[questionId];
        <span class="code-keyword">require</span>(<span class="code-value">"이미 해결됨"</span>);
        <span class="code-keyword">require</span>(block.timestamp >= market.deadline, <span class="code-value">"너무 이름"</span>);

        <span class="code-comment">// 체인링크에서 최신 가격 가져오기</span>
        (, int256 price, , , ) = priceFeed.latestRoundData();

        <span class="code-comment">// 승자 결정</span>
        bool yesWins = market.resolveAbove
            ? price > int256(market.threshold)
            : price < int256(market.threshold);

        <span class="code-comment">// CTF에 배당 보고</span>
        uint256[] memory payouts = new uint256[](2);
        payouts[0] = yesWins ? 1 : 0;  <span class="code-comment">// YES 결과</span>
        payouts[1] = yesWins ? 0 : 1;  <span class="code-comment">// NO 결과</span>

        ctf.reportPayouts(questionId, payouts);
        market.resolved = <span class="code-keyword">true</span>;
    }
}
            </pre>

            <h4>Chainlink Functions 예시 (JavaScript)</h4>
            <pre>
<span class="code-comment">// 이 코드는 Chainlink Functions DON에서 실행됩니다</span>
<span class="code-keyword">const</span> apiEndpoint = args[0];  <span class="code-comment">// 예: "https://api.sportsdata.io/..."\</span\>
<span class="code-keyword">const</span> jsonPath = args[1];     <span class="code-comment">// 예: "Games[0].Winner"</span>

<span class="code-keyword">const</span> response = <span class="code-keyword">await</span> Functions.makeHttpRequest({
  url: apiEndpoint,
  headers: { <span class="code-value">"Ocp-Apim-Subscription-Key"</span>: secrets.apiKey }
});

<span class="code-keyword">if</span> (response.error) {
  <span class="code-keyword">throw</span> Error(<span class="code-value">"API 요청 실패"</span>);
}

<span class="code-comment">// JSON 경로 탐색 및 결과 반환</span>
<span class="code-keyword">const</span> homeTeamWins = result === <span class="code-value">"HomeTeam"</span> ? 1 : 0;
<span class="code-keyword">return</span> Functions.encodeUint256(homeTeamWins);
            </pre>

            <h4>네트워크 주소</h4>
            <div class="grid-2">
                <div class="card">
                    <h4>BSC Testnet</h4>
                    <pre style="font-size: 0.75rem;">LINK: 0x84b9B910527Ad5C03A9Ca831909E21e236EA7b06
BTC/USD: 0x5741306c21795FdCBb9b265Ea0255F499DFe515C
ETH/USD: 0x143db3CEEfbdfe5631aDD3E50f7614B6ba708BA7
BNB/USD: 0x2514895c72f50D8bd4B4F9b1110F0D6bD2c97526</pre>
                </div>
                <div class="card">
                    <h4>Polygon Amoy</h4>
                    <pre style="font-size: 0.75rem;">Functions Router: 0xC22a79eBA640940ABB6dF0f7982cc119578E11De
BTC/USD: 0xe7656e23fE8077D438aEfbec2fAbDf2D8e070C4f
ETH/USD: 0xF0d50568e3A7e8259E16663972b11910F89BD8e7</pre>
                </div>
            </div>
        </section>

        <!-- Section 3.7: Cost & Security -->
        <section id="cost-security" class="part-3-section">
            <h3><span class="section-num part-3">3.7</span>비용 및 보안 고려사항</h3>

            <h4>월간 비용 추정 (시장 100개 기준)</h4>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>컴포넌트</th>
                            <th>사용당 비용</th>
                            <th>월간 (100개 시장)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Data Feeds (읽기)</td>
                            <td><span class="label label-success">무료</span></td>
                            <td>/opt/homebrew/bin/zsh</td>
                        </tr>
                        <tr>
                            <td>Functions 요청</td>
                            <td>~0.25 LINK</td>
                            <td>25 LINK (~)</td>
                        </tr>
                        <tr>
                            <td>Automation 확인</td>
                            <td>~0.01 LINK</td>
                            <td>30 LINK (~)</td>
                        </tr>
                        <tr>
                            <td>Automation 실행</td>
                            <td>~0.1 LINK</td>
                            <td>10 LINK (~)</td>
                        </tr>
                        <tr>
                            <td><strong>합계</strong></td>
                            <td></td>
                            <td><strong>~65 LINK (~)</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h4>보안 고려사항</h4>
            <div class="grid-2">
                <div class="card">
                    <h4>신뢰 가정</h4>
                    <ul style="font-size: 0.875rem;">
                        <li><strong>Data Feeds:</strong> 높은 신뢰 (탈중앙화 노드)</li>
                        <li><strong>Functions:</strong> 중간 (API에 의존)</li>
                        <li><strong>API 소스:</strong> 제공자에 따라 다름</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>필수 확인 사항</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>체인링크 응답 데이터 검증</li>
                        <li>Functions 오류 우아하게 처리</li>
                        <li>수동 해결로의 폴백(fallback) 구현</li>
                        <li>적절한 가스 한도 설정</li>
                        <li>구독 잔액 모니터링</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Section 3.8: Implementation Roadmap -->
        <section id="roadmap" class="part-3-section">
            <h3><span class="section-num part-3">3.8</span>구현 로드맵</h3>

            <div class="grid-2">
                <div class="card">
                    <h4>1단계: Price Feed 시장 (1-2주차)</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>PriceFeedResolver 컨트랙트 배포</li>
                        <li>BTC/USD, ETH/USD 피드로 테스트</li>
                        <li>"BTC가  넘을까?" 시장 생성</li>
                        <li>프론트엔드 해결 페이지 업데이트</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>2단계: 자동화 (3주차)</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>리졸버에 AutomationCompatible 추가</li>
                        <li>체인링크에 Upkeep 등록</li>
                        <li>마감 시 자동 해결 테스트</li>
                        <li>가스 설정 모니터링 및 조정</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>3단계: Functions (4-5주차)</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Functions 구독 설정</li>
                        <li>FunctionsResolver 컨트랙트 배포</li>
                        <li>스포츠 API용 자바스크립트 작성</li>
                        <li>엣지 케이스 처리 (API 다운 등)</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>4단계: 프로덕션 (6주차)</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>보안 감사</li>
                        <li>메인넷 배포</li>
                        <li>모니터링 대시보드</li>
                        <li>관리자 폴백 절차</li>
                    </ul>
                </div>
            </div>
        </section>

        <footer>
            <p>Nostra 기술 백서 | 버전 1.0 | 2025년 12월</p>
        </footer>
    </div>
</body>

</html>
